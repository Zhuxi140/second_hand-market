# ä»¿é—²é±¼äºŒæ‰‹äº¤æ˜“å¹³å°æ¥å£è®¾è®¡æ–‡æ¡£ï¼ˆå­¦ç”Ÿç‰ˆï¼‰

## 1. æ¥å£è®¾è®¡åŸåˆ™

### 1.1 RESTful API è®¾è®¡è§„èŒƒ

- ä½¿ç”¨HTTPåŠ¨è¯è¡¨ç¤ºæ“ä½œï¼šGETã€POSTã€PUTã€DELETE
- ä½¿ç”¨åè¯è¡¨ç¤ºèµ„æºï¼š/usersã€/productsã€/orders
- ä½¿ç”¨å¤æ•°å½¢å¼è¡¨ç¤ºé›†åˆ
- ä½¿ç”¨å±‚çº§ç»“æ„è¡¨ç¤ºèµ„æºå…³ç³»ï¼š/users/{id}/orders

### 1.2 ç»Ÿä¸€å“åº”æ ¼å¼

```json
{
  "code": 200,
  "message": "success",
  "data": {},
  "timestamp": 1640995200000         //ä¸‹é¢çš„æ¥å£ä¸­çš„å“åº”ä½“ ä¸ºäº†æ›´ç®€æ´å¯èƒ½æ²¡æœ‰å†™è¿™ä¸ªå­—æ®µ ä½†å®é™…ä¸Šæ˜¯æœ‰çš„
}
```

### 1.3 åˆ†é¡µå“åº”æ ¼å¼

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [],
    "total": 100,
    "page": 1,
    "size": 20
  }
}
```

### 1.4 é”™è¯¯ç è§„èŒƒ

- 200ï¼šæˆåŠŸ
- 400ï¼šå®¢æˆ·ç«¯é”™è¯¯
- 401ï¼šæœªæˆæƒ
- 403ï¼šç¦æ­¢è®¿é—®
- 404ï¼šèµ„æºä¸å­˜åœ¨
- 500ï¼šæœåŠ¡å™¨é”™è¯¯

## 2. è®¤è¯æˆæƒ

### 2.1 Token è®¤è¯

```http
Access-Token(JWT)  :Authorization: Bearer <token>   //ç”¨ä½œçŸ­æ—¶å‡­è¯ 
```

```http
Refresh-Token : åç«¯ç”Ÿæˆä¸€ä¸ªé•¿æ—¶Tokenï¼ˆå­˜å…¥æ•°æ®åº“ï¼‰ å‰ç«¯ç”¨å…¶åœ¨çŸ­æ—¶è¿‡æœŸåå†æ¬¡è·å–æ–°çš„çŸ­æ—¶Token
```

#### è·å–çŸ­æ—¶Token(Access-Token) (æœ‰é—®é¢˜ å¾…å¤„ç†-åˆ·æ–°ä»¤ç‰Œæ—‹è½¬ç­–ç•¥/æ¶ˆæ¯ä½“ç¼ºå°‘å­—æ®µ)

```http
POST  /auth/AccessToken
```

##### è¯·æ±‚ä½“

```json
{
 "refreshToken": "dasdasdsadsadsad"
}
```

##### å“åº”ä½“

```json
{
  "code": 200,
  "message": "success",
  "data": {
      "accessToken": "dadsadsadsadsadasd"
  }
}
```

### 2.2 æ¥å£æƒé™æ§åˆ¶

- å…¬å¼€æ¥å£ï¼šæ— éœ€è®¤è¯
- ç”¨æˆ·æ¥å£-ï¼ˆä¸ªäººè´¦æˆ·ï¼Œå•†å®¶è´¦æˆ·ï¼‰ï¼š éœ€è¦ç”¨æˆ·è®¤è¯
- ç®¡ç†å‘˜æ¥å£-ï¼ˆæ™®é€šç®¡ç†å‘˜ï¼Œè¶…çº§ç®¡ç†å‘˜ï¼‰ï¼šéœ€è¦ç®¡ç†å‘˜è®¤è¯

### 2.3 Redisç¼“å­˜ç­–ç•¥

- **ç”¨æˆ·ä¿¡æ¯ç¼“å­˜**ï¼šç”¨æˆ·ç™»å½•åç¼“å­˜ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ï¼Œå‡å°‘æ•°æ®åº“æŸ¥è¯¢
- **å•†å“åˆ—è¡¨ç¼“å­˜**ï¼šçƒ­é—¨å•†å“åˆ—è¡¨ç¼“å­˜30åˆ†é’Ÿï¼Œæé«˜æŸ¥è¯¢æ€§èƒ½
- **å•†å“è¯¦æƒ…ç¼“å­˜**ï¼šå•†å“è¯¦æƒ…ç¼“å­˜1å°æ—¶ï¼Œæµè§ˆé‡å®æ—¶æ›´æ–°
- **åˆ†ç±»æ•°æ®ç¼“å­˜**ï¼šå•†å“åˆ†ç±»æ•°æ®ç¼“å­˜24å°æ—¶ï¼Œå¾ˆå°‘å˜åŠ¨
- **Tokené»‘åå•**ï¼šç”¨æˆ·ç™»å‡ºåTokenåŠ å…¥Redisé»‘åå•ï¼Œå®ç°å®‰å…¨ç™»å‡º

## 3. ç”¨æˆ·ç®¡ç†æ¥å£ ğŸ”´

### 3.1 ç”¨æˆ·æ³¨å†Œç™»å½•

#### 3.1.1 ç”¨æˆ·æ³¨å†Œ

```http
POST /user/register
Content-Type: application/json
æ³¨æ„:  å½“å‰ä¸ºä¸€æœŸå¼€å‘ æš‚ä¸é›†æˆæ‰‹æœºå·éªŒè¯ç æˆ–é‚®ç®±éªŒè¯ç 
```

**è¯·æ±‚ä½“ï¼š**

```json
{
  "username": "testuser",
  "password": "password123",
  "phone": "13800138000"
}
```

**å“åº”ä½“ï¼š**

```json
{
  "code": 200,
  "message": "æ³¨å†ŒæˆåŠŸ",
  "data": {
    "userSn": "USR202401010001",     //ç”¨æˆ·å”¯ä¸€æ ‡è¯†
    "username": "testuser",          // ç”¨æˆ·å
    "avatar": "https://example.com/avatar.jpg",             //ç”¨æˆ·å¤´åƒ
    "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",  //çŸ­æ—¶Token
    "refreshToken" : "weadsadgvdsbfdgesfszhcvixuvklxcn...",       //é•¿æ—¶Token
    "expireTime": 1640995200000  //çŸ­æ—¶Tokenè¿‡æœŸæ—¶é—´
  }
}
```

#### 3.1.2 ç”¨æˆ·ç™»å½•

```http
POST /user/login
Content-Type: application/json
```

**è¯·æ±‚ä½“ï¼š**

```json
{
  "username": "testuser",
  "password": "password123"
}
```

**å“åº”ä½“ï¼š**

```json
{
  "code": 200,
  "message": "ç™»å½•æˆåŠŸ",
  "data": {
    "userSn": "USR202401010001",
    "username": "testuser",
    "nickname": "ç”¨æˆ·æ˜µç§°",
    "role": 
    "avatar": "https://example.com/avatar.jpg",
        "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",  //çŸ­æ—¶Token
    "refreshToken" : "weadsadgvdsbfdgesfszhcvixuvklxcn...",       //é•¿æ—¶Token
    "expireTime": 1640995200000  //çŸ­æ—¶Tokenè¿‡æœŸæ—¶é—´
  }
}
```

#### 3.1.3 ç”¨æˆ·ç™»å‡º

```http
POST /user/logout
Authorization: Bearer <token>
```

**è¯·æ±‚å‚æ•°ï¼š** æ— 

**å“åº”ä½“ï¼š**

```json
{
  "code": 200,
  "message": "ç™»å‡ºæˆåŠŸ",
  "data": null
}
```

### 3.2 ç”¨æˆ·ä¿¡æ¯ç®¡ç†

#### 3.2.1 è·å–ç”¨æˆ·ä¿¡æ¯

```http
GET /user/getInfo/{userSn}
Authorization: Bearer <token>
```

**è¯·æ±‚å‚æ•°ï¼š**

- `userSn` (è·¯å¾„å‚æ•°): ç”¨æˆ·ç¼–å·

**å“åº”ä½“ï¼š**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "userSn": "USR202401010001",
    "username": "testuser",
    "nickname": "ç”¨æˆ·æ˜µç§°",
    "gender": "ç”·",
    "phone": "13800138000",
    "avatar": "https://example.com/avatar.jpg",
    "role": "user",
    "status": 1,
    "createdAt": "2024-01-01T00:00:00Z"
  }
}
```

#### 3.2.2 æ›´æ–°ç”¨æˆ·ä¿¡æ¯

```http
PUT /user/update/{userSn}
Authorization: Bearer <token>
Content-Type: application/json
```

**è¯·æ±‚å‚æ•°ï¼š**

- `userSn` (è·¯å¾„å‚æ•°): ç”¨æˆ·ç¼–å·

**è¯·æ±‚ä½“ï¼š**

```json
{
  "nickname": "æ–°æ˜µç§°",
  "avatar": "https://example.com/avatar.jpg"ï¼Œ
  "gender": "ç”·" 
}
```

**å“åº”ä½“ï¼š**

```json
{
  "code": 200,
  "message": "æ›´æ–°æˆåŠŸ",
  "data": null
}
```

#### 3.2.3 ä¿®æ”¹å¯†ç 

```http
PUT /user/{userSn}/password
Authorization: Bearer <token>
Content-Type: application/json
```

**è¯·æ±‚å‚æ•°ï¼š**

- `userSn` (è·¯å¾„å‚æ•°): ç”¨æˆ·ç¼–å·

**è¯·æ±‚ä½“ï¼š**

```json
{
  "oldPassword": "oldpassword",
  "newPassword": "newpassword"
}
```

**å“åº”ä½“ï¼š**

```json
{
  "code": 200,
  "message": "å¯†ç ä¿®æ”¹æˆåŠŸ",
  "data": null
}
```

### 3.3 åœ°å€ç®¡ç†

#### 3.3.1 è·å–ç”¨æˆ·åœ°å€åˆ—è¡¨

```http
GET /user/{userSn}/addresses
Authorization: Bearer <token>
```

**è¯·æ±‚å‚æ•°ï¼š**

- `userSn` (è·¯å¾„å‚æ•°): ç”¨æˆ·ç¼–å·

**å“åº”ä½“ï¼š**

```json
{
  "code": 200,
  "message": "success",
  "data": [
    {
      "addressSn": "ADDR202401010001",
      "consignee": "å¼ ä¸‰",
      "sex": "ç”·",
      "phone": "13800138000",
      "provinceName": "åŒ—äº¬å¸‚",
      "cityName": "åŒ—äº¬å¸‚",
      "districtName": "ä¸œåŸåŒº",
      "detail": "æŸæŸè¡—é“123å·",
      "label": "å®¶",
      "isDefault": true,
      "createdAt": "2024-01-01T00:00:00Z"
    }
  ]
}
```

#### 3.3.2 æ·»åŠ åœ°å€

```http
POST /user/{userSn}/addresses
Authorization: Bearer <token>
Content-Type: application/json
```

**è¯·æ±‚å‚æ•°ï¼š**

- `userSn` (è·¯å¾„å‚æ•°): ç”¨æˆ·ç¼–å·

**è¯·æ±‚ä½“ï¼š**

```json
{
  "consignee": "å¼ ä¸‰",
  "phone": "13800138000",
  "provinceName": "åŒ—äº¬å¸‚",
  "cityName": "åŒ—äº¬å¸‚",
  "districtName": "ä¸œåŸåŒº",
  "detail": "æŸæŸè¡—é“123å·",
  "label": "å®¶",
  "isDefault": true
}
```

**å“åº”ä½“ï¼š**

```json
{
  "code": 200,
  "message": "åœ°å€æ·»åŠ æˆåŠŸ",
  "data": {
    "addressSn": "ADDR202401010001"
  }
}
```

#### 3.3.3 æ›´æ–°åœ°å€

```http
PUT /user/{userSn}/addresses/{addressSn}
Authorization: Bearer <token>
Content-Type: application/json
```

**è¯·æ±‚å‚æ•°ï¼š**

- `userSn` (è·¯å¾„å‚æ•°): ç”¨æˆ·ç¼–å·
- `addressSn` (è·¯å¾„å‚æ•°): åœ°å€ç¼–å·

**è¯·æ±‚ä½“ï¼š**

```json
{
  "consignee": "æå››",
  "phone": "13900139000",
  "provinceName": "ä¸Šæµ·å¸‚",
  "cityName": "ä¸Šæµ·å¸‚",
  "districtName": "æµ¦ä¸œæ–°åŒº",
  "detail": "æŸæŸè·¯456å·",
  "label": "å…¬å¸",
  "isDefault": false
}
```

**å“åº”ä½“ï¼š**

```json
{
  "code": 200,
  "message": "åœ°å€æ›´æ–°æˆåŠŸ",
  "data": null
}
```

#### 3.3.4 åˆ é™¤åœ°å€

```http
DELETE /user/{userSn}/addresses/{addressSn}
Authorization: Bearer <token>
```

**è¯·æ±‚å‚æ•°ï¼š**

- `userSn` (è·¯å¾„å‚æ•°): ç”¨æˆ·ç¼–å·
- `addressSn` (è·¯å¾„å‚æ•°): åœ°å€ç¼–å·

**å“åº”ä½“ï¼š**

```json
{
  "code": 200,
  "message": "åœ°å€åˆ é™¤æˆåŠŸ",
  "data": null
}
```

## 4. å•†å“ç®¡ç†æ¥å£ ğŸ”´

### 4.1 å•†å“åˆ†ç±»

#### 4.1.1 è·å–åˆ†ç±»åˆ—è¡¨

```http
GET /product/categories
```

**å“åº”ï¼š**

```json
{
  "code": 200,
  "message": "success",
  "data": [
    {
      "id": 1,
      "name": "æ•°ç äº§å“",
      "parentId": 0,
      "children": [
        {
          "id": 2,
          "name": "æ‰‹æœº",
          "parentId": 1
        }
      ]
    }
  ]
}
```

### 4.2 å•†å“ç®¡ç†

#### 4.2.1 å‘å¸ƒå•†å“

```http
POST /product/new
Authorization: Bearer <token>
Content-Type: application/json
```

**è¯·æ±‚ä½“ï¼š**

```json
{
  "title": "iPhone 13 Pro Max",
  "description": "99æ–°iPhone 13 Pro Maxï¼Œæ— ç£•ç¢°",
  "categoryId": 1,
  "price": 6999.00,
  "condition": 2,
  "location": "åŒ—äº¬å¸‚æœé˜³åŒº",
  "images": [
    {
      "url": "https://example.com/image1.jpg",
      "type": 1,
      "sortOrder": 1
    }
  ]
}
```

**å“åº”ä½“ï¼š**

```json
{
  "code": 200,
  "message": "å•†å“å‘å¸ƒæˆåŠŸ",
  "data": {
    "productSn": "PRD202401010001"
  }
}
```

#### 4.2.2 è·å–å•†å“åˆ—è¡¨

```http
GET /product/list?page=1&size=20&categorySn=CAT202401010002&keyword=iPhone&minPrice=1000&maxPrice=10000&location=åŒ—äº¬&sortBy=price&sortOrder=asc
```

**è¯·æ±‚å‚æ•°ï¼š**

- `page` (æŸ¥è¯¢å‚æ•°): é¡µç ï¼Œé»˜è®¤1
- `size` (æŸ¥è¯¢å‚æ•°): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤20
- `categorySn` (æŸ¥è¯¢å‚æ•°): åˆ†ç±»ä¸šåŠ¡ç¼–å·
- `keyword` (æŸ¥è¯¢å‚æ•°): æœç´¢å…³é”®è¯
- `minPrice` (æŸ¥è¯¢å‚æ•°): æœ€ä½ä»·æ ¼
- `maxPrice` (æŸ¥è¯¢å‚æ•°): æœ€é«˜ä»·æ ¼
- `location` (æŸ¥è¯¢å‚æ•°): åœ°åŒº
- `sortBy` (æŸ¥è¯¢å‚æ•°): æ’åºå­—æ®µï¼ˆprice, time, viewCountï¼‰
- `sortOrder` (æŸ¥è¯¢å‚æ•°): æ’åºæ–¹å‘ï¼ˆasc, descï¼‰

**å“åº”ä½“ï¼š**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [
      {
        "productSn": "PRD202401010001",
        "title": "iPhone 13 Pro Max",
        "price": 6999.00,
        "condition": 2,
        "location": "åŒ—äº¬å¸‚æœé˜³åŒº",
        "viewCount": 156,
        "sellerSn": "USR202401010001",
        "sellerNickname": "å–å®¶æ˜µç§°",
        "coverImage": "https://example.com/cover.jpg",
        "createdAt": "2024-01-01T00:00:00Z"
      }
    ],
    "total": 100,
    "page": 1,
    "size": 20
  }
}
```

#### 4.2.3 è·å–å•†å“è¯¦æƒ…

```http
GET /product/{productSn}
```

**è¯·æ±‚å‚æ•°ï¼š**

- `productSn` (è·¯å¾„å‚æ•°): å•†å“ç¼–å·

**å“åº”ä½“ï¼š**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "productSn": "PRD202401010001",
    "title": "iPhone 13 Pro Max",
    "description": "99æ–°iPhone 13 Pro Maxï¼Œæ— ç£•ç¢°",
    "categoryId": 2,
    "categoryName": "æ‰‹æœº",
    "price": 6999.00,
    "condition": 2,
    "conditionText": "9æˆæ–°",
    "status": 1,
    "location": "åŒ—äº¬å¸‚æœé˜³åŒº",
    "viewCount": 156,
    "sellerSn": "USR202401010001",
    "sellerNickname": "å–å®¶æ˜µç§°",
    "sellerAvatar": "https://example.com/avatar.jpg",
    "images": [
      {
        "url": "https://example.com/image1.jpg",
        "type": 1,
        "sortOrder": 1
      }
    ],
    "createdAt": "2024-01-01T00:00:00Z"
  }
}
```

#### 4.2.4 æ›´æ–°å•†å“

```http
PUT /product/{productSn}
Authorization: Bearer <token>
Content-Type: application/json
```

**è¯·æ±‚å‚æ•°ï¼š**

- `productSn` (è·¯å¾„å‚æ•°): å•†å“ç¼–å·

**è¯·æ±‚ä½“ï¼š**

```json
{
  "title": "iPhone 13 Pro Max æ›´æ–°",
  "description": "æ›´æ–°åçš„æè¿°",
  "price": 6500.00,
  "condition": 3,
  "categoryId": 2,
  "location": "åŒ—äº¬å¸‚æµ·æ·€åŒº"
}
```

**å“åº”ä½“ï¼š**

```json
{
  "code": 200,
  "message": "å•†å“æ›´æ–°æˆåŠŸ",
  "data": null
}
```

#### 4.2.5 åˆ é™¤å•†å“

```http
DELETE /api/v1/products/{productSn}
Authorization: Bearer <token>
```

**è¯·æ±‚å‚æ•°ï¼š**

- `productSn` (è·¯å¾„å‚æ•°): å•†å“ç¼–å·

**å“åº”ä½“ï¼š**

```json
{
  "code": 200,
  "message": "å•†å“åˆ é™¤æˆåŠŸ",
  "data": null
}
```

#### 4.2.6 è·å–æˆ‘çš„å•†å“

```http
GET /user/{userSn}/products?page=1&size=20&status=1
Authorization: Bearer <token>
```

**è¯·æ±‚å‚æ•°ï¼š**

- `userSn` (è·¯å¾„å‚æ•°): ç”¨æˆ·ä¸šåŠ¡ç¼–å·
- `page` (æŸ¥è¯¢å‚æ•°): é¡µç ï¼Œé»˜è®¤1
- `size` (æŸ¥è¯¢å‚æ•°): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤20
- `status` (æŸ¥è¯¢å‚æ•°): å•†å“çŠ¶æ€

**å“åº”ä½“ï¼š**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [
      {
        "productSn": "PRD202401010001",
        "title": "iPhone 13 Pro Max",
        "price": 6999.00,
        "status": 1,
        "viewCount": 156,
        "createdAt": "2024-01-01T00:00:00Z"
      }
    ],
    "total": 10,
    "page": 1,
    "size": 20
  }
}
```

### 4.3 å•†å“å›¾ç‰‡

#### 4.3.1 ä¸Šä¼ å•†å“å›¾ç‰‡

```http
POST /api/v1/products/images/upload
Authorization: Bearer <token>
Content-Type: multipart/form-data

file: <image_file>
```

#### 4.3.2 åˆ é™¤å•†å“å›¾ç‰‡

```http
DELETE /api/v1/products/{productId}/images/{imageId}
Authorization: Bearer <token>
```

## 5. è®¢å•ç®¡ç†æ¥å£ ğŸ”´

### 5.1 è®¢å•æ“ä½œ

#### 5.1.1 åˆ›å»ºè®¢å•

```http
POST /orders
Authorization: Bearer <token>
Content-Type: application/json
```

**è¯·æ±‚ä½“ï¼š**

```json

  "items": [
    {
      "productSn": "PRD202401010001",
      "quantity": 1,
      "addressSn": "ADDR202401010001"
    }
  ]
```

**å“åº”ä½“ï¼š**

```json
{
  "code": 200,
  "message": "è®¢å•åˆ›å»ºæˆåŠŸ",
  "data": {
  "orderSn": "ORD202401010001"
  }
}
```

#### 5.1.2 è·å–è®¢å•åˆ—è¡¨

```http
GET /user/{userSn}/orders?page=1&size=20&status=1&type=buyer
Authorization: Bearer <token>
```

**è¯·æ±‚å‚æ•°ï¼š**

- `userSn` (è·¯å¾„å‚æ•°): ç”¨æˆ·ä¸šåŠ¡ç¼–å·
- `page` (æŸ¥è¯¢å‚æ•°): é¡µç ï¼Œé»˜è®¤1
- `size` (æŸ¥è¯¢å‚æ•°): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤20
- `status` (æŸ¥è¯¢å‚æ•°): è®¢å•çŠ¶æ€
- `type` (æŸ¥è¯¢å‚æ•°): è®¢å•ç±»å‹ï¼ˆbuyer: ä½œä¸ºä¹°å®¶, seller: ä½œä¸ºå–å®¶ï¼‰

**å“åº”ä½“ï¼š**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [
      {
        "orderSn": "ORD202401010001",
        "totalAmount": 6999.00,
        "status": 1,
        "productQuantity": 1,
        "createdAt": "2024-01-01T00:00:00Z"
      }
    ],
    "total": 10,
    "page": 1,
    "size": 20
  }
}
```

#### 5.1.3 è·å–è®¢å•è¯¦æƒ…

```http
GET /order/{orderSn}
Authorization: Bearer <token>
```

**è¯·æ±‚å‚æ•°ï¼š**

- `orderSn` (è·¯å¾„å‚æ•°): è®¢å•ç¼–å·

**å“åº”ä½“ï¼š**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "orderSn": "ORD202401010001",
    "buyerSn": "USR202401010001",
    "buyerNickname": "ä¹°å®¶æ˜µç§°",
    "totalAmount": 6999.00,
    "status": 1,
    "receiveAddress": {
      "addressSn": "ADDR202401010001",
      "consignee": "å¼ ä¸‰",
      "phone": "13800138000",
      "fullAddress": "åŒ—äº¬å¸‚ä¸œåŸåŒºæŸæŸè¡—é“123å·"
    },
    "items": [
      {
        "productSn": "PRD202401010001",
        "productTitle": "iPhone 13 Pro Max",
        "productImage": "https://example.com/cover.jpg",
        "quantity": 1,
        "unitPrice": 6999.00,
        "sellerSn": "USR202401010002",
        "sellerNickname": "å–å®¶æ˜µç§°"
      }
    ],
    "remark": "è¯·å°½å¿«å‘è´§",
    "createdAt": "2024-01-01T00:00:00Z"
  }
}
```

#### 5.1.4 å–æ¶ˆè®¢å•

```http
PUT /order/{orderSn}/cancel
Authorization: Bearer <token>
Content-Type: application/json
```

**è¯·æ±‚å‚æ•°ï¼š**

- `orderSn` (è·¯å¾„å‚æ•°): è®¢å•ä¸šåŠ¡ç¼–å·

**è¯·æ±‚ä½“ï¼š**

```json
{
  "reason": "ä¸æƒ³è¦äº†"
}
```

**å“åº”ä½“ï¼š**

```json
{
  "code": 200,
  "message": "è®¢å•å–æ¶ˆæˆåŠŸ",
  "data": null
}
```

#### 5.1.5 ç¡®è®¤æ”¶è´§

```http
PUT /order/{orderSn}/confirm
Authorization: Bearer <token>
```

**è¯·æ±‚å‚æ•°ï¼š**

- `orderSn` (è·¯å¾„å‚æ•°): è®¢å•ç¼–å·

**å“åº”ä½“ï¼š**

```json
{
  "code": 200,
  "message": "ç¡®è®¤æ”¶è´§æˆåŠŸ",
  "data": null
}
```

### 5.2 è®¢å•çŠ¶æ€ç®¡ç†

#### 5.2.1 æ›´æ–°è®¢å•çŠ¶æ€ï¼ˆå–å®¶ï¼‰

```http
PUT /order/{orderSn}/status
Authorization: Bearer <token>
Content-Type: application/json

è¯·æ±‚å‚æ•°ï¼ˆè·¯å¾„å‚æ•°ï¼‰: orderSn

{
  "status": 2,
  "remark": "å·²å‘è´§ï¼Œå¿«é€’å•å·ï¼šSF1234567890"
}
```

## 6. æ”¶è—æ¥å£ ğŸ”´

### 6.1 æ”¶è—ç®¡ç†

#### 6.1.1 æ”¶è—å•†å“

```http
POST /user/{userSn}/collections
Authorization: Bearer <token>
Content-Type: application/json

è¯·æ±‚å‚æ•°(è·¯å¾„å‚æ•°): userSn

{
  "productSn": "wdasdada..."
}
```

#### 6.1.2 å–æ¶ˆæ”¶è—

```http
DELETE /user/{userSn}/collections/{productSn}
Authorization: Bearer <token>

è¯·æ±‚å‚æ•°(è·¯å¾„å‚æ•°): userSn,productSn
```

#### 6.1.3 è·å–æ”¶è—åˆ—è¡¨

```http
GET /user/{userSn}collections?page=1&size=20
Authorization: Bearer <token>

è¯·æ±‚å‚æ•°ï¼ˆè·¯å¾„å‚æ•°ï¼‰: userSn


å“åº”ä½“: 
{
  "code": 200,
  "message": "success",
  "data": [
  	    {
        "productSn": "PRD202401010001",
        "title": "iPhone 13 Pro Max",
        "price": 6999.00,
        "condition": 2,
        "viewCount": 156,
        "sellerSn": "USR202401010001",
        "sellerNickname": "å–å®¶æ˜µç§°",
        "coverImage": "https://example.com/cover.jpg",
        "createdAt": "2024-01-01T00:00:00Z"
      }
  	]
}
```

## 7. æœç´¢æ¥å£ ğŸ”´

### 7.1 æœç´¢åŠŸèƒ½

#### 7.1.1 å•†å“æœç´¢

```http
GET /search/products?q=iPhone&page=1&size=20&filters={"categoryId":2,"minPrice":1000,"maxPrice":10000}
```

#### 7.1.2 æœç´¢å»ºè®®

```http
GET /search/suggestions?q=iPh
```

## 8. æ–‡ä»¶ä¸Šä¼ æ¥å£ ğŸ”´

### 8.1 æ–‡ä»¶ä¸Šä¼ 

#### 8.1.1 ä¸Šä¼ å›¾ç‰‡

```http
POST /upload/image
Authorization: Bearer <token>
Content-Type: multipart/form-data

file: <image_file>
```

#### 8.1.2 ä¸Šä¼ å¤´åƒ

```http
POST /upload/avatar
Authorization: Bearer <token>
Content-Type: multipart/form-data

file: <avatar_file>
```

## 9. é€šè®¯æ¥å£ ğŸŸ¡

### 9.1 èŠå¤©ç®¡ç†

#### 9.1.1 è·å–ä¼šè¯åˆ—è¡¨

```http
GET /chat/conversations
Authorization: Bearer <token>
```

#### 9.1.2 è·å–èŠå¤©è®°å½•

```http
GET /chat/conversations/{conversationId}/messages?page=1&size=50
Authorization: Bearer <token>
```

#### 9.1.3 å‘é€æ¶ˆæ¯

```http
POST /chat/messages
Authorization: Bearer <token>
Content-Type: application/json

{
  "conversationId": "conv_123",
  "receiverId": 2,
  "content": "ä½ å¥½ï¼Œè¿™ä¸ªå•†å“è¿˜åœ¨å—ï¼Ÿ",
  "type": "text"
}
```

#### 9.1.4 æ ‡è®°æ¶ˆæ¯å·²è¯»

```http
PUT /chat/messages/{messageId}/read
Authorization: Bearer <token>
```

### 9.2 WebSocket å®æ—¶é€šè®¯

#### 9.2.1 è¿æ¥WebSocket

```javascript
const ws = new WebSocket('ws://localhost:8080/ws/chat?token=<jwt_token>');
```

## 10. è¯„ä»·æ¥å£ ğŸŸ¡

### 10.1 è¯„ä»·ç®¡ç†

#### 10.1.1 åˆ›å»ºè¯„ä»·

```http
POST /order/{orderSn}/comment
Authorization: Bearer <token>
Content-Type: application/json

{
  "rating": 5,
  "comment": "å•†å“å¾ˆå¥½ï¼Œå–å®¶å¾ˆniceï¼"
}
```

#### 10.1.2 è·å–ç”¨æˆ·è¯„ä»·

```http
GET /user/{userSn}/comments?page=1&size=20
```

## 11. ç³»ç»Ÿç®¡ç†æ¥å£ ğŸŸ¡

### 11.1 ç®¡ç†å‘˜æ¥å£

#### 11.1.1 ç®¡ç†å‘˜ç™»å½•

```http
POST /admin/auth/login
Content-Type: application/json

{
  "username": "admin",
  "password": "admin123"
}
```

#### 11.1.2 è·å–ç”¨æˆ·åˆ—è¡¨

```http
GET /admin/users?page=1&size=20&status=1
Authorization: Bearer <admin_token>
```

#### 11.1.3 å®¡æ ¸å•†å“

```http
PUT /admin/products/{productSn}/audit
Authorization: Bearer <admin_token>
Content-Type: application/json

{
  "status": "approved",
  "remark": "å®¡æ ¸é€šè¿‡"
}
```

#### 11.1.4 åˆ†ç±»ç®¡ç†

```http
GET /admin/categories
POST /admin/categories
PUT /categories/{categoryId}
DELETE /admin/categories/{categoryId}
```

## 12. æ¥å£å®ç°è¦ç‚¹

### 12.1 å¿…åšåŠŸèƒ½å®ç° ğŸ”´

#### 12.1.1 ç”¨æˆ·è®¤è¯

- ä½¿ç”¨Spring Security + JWT
- å¯†ç ä½¿ç”¨BCryptåŠ å¯†
- å®ç°ç™»å½•æ‹¦æˆªå™¨

#### 12.1.2 å•†å“ç®¡ç†

- æ–‡ä»¶ä¸Šä¼ ä½¿ç”¨MultipartFile
- å›¾ç‰‡å­˜å‚¨åˆ°æœ¬åœ°æˆ–äº‘å­˜å‚¨
- ä½¿ç”¨PageHelperå®ç°åˆ†é¡µ

#### 12.1.3 è®¢å•ç®¡ç†

- ä½¿ç”¨@Transactionalä¿è¯äº‹åŠ¡
- è®¢å•çŠ¶æ€ä½¿ç”¨æšä¸¾ç®¡ç†
- ä½¿ç”¨ä¹è§‚é”å¤„ç†å¹¶å‘

#### 12.1.4 ç¼“å­˜ä¼˜åŒ–

- ä½¿ç”¨Redisç¼“å­˜çƒ­é—¨å•†å“
- ç¼“å­˜ç”¨æˆ·ä¿¡æ¯
- ç¼“å­˜åˆ†ç±»æ•°æ®

### 12.2 é€‰åšåŠŸèƒ½å®ç° ğŸŸ¡

#### 12.2.1 é€šè®¯åŠŸèƒ½

- ä½¿ç”¨WebSocketå®ç°å®æ—¶é€šè®¯
- æ¶ˆæ¯å­˜å‚¨åˆ°æ•°æ®åº“
- å®ç°åœ¨çº¿çŠ¶æ€ç®¡ç†

#### 12.2.2 è¯„ä»·ç³»ç»Ÿ

- å®ç°è¯„åˆ†è®¡ç®—é€»è¾‘
- è¯„ä»·æ•°æ®ç»Ÿè®¡å±•ç¤º

### 12.3 æŠ€æœ¯éš¾ç‚¹

#### 12.3.1 æ€§èƒ½ä¼˜åŒ–

- æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–
- Redisç¼“å­˜ç­–ç•¥
- åˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–

#### 12.3.2 å¹¶å‘å¤„ç†

- ä¹è§‚é”å¤„ç†åº“å­˜
- åˆ†å¸ƒå¼é”å®ç°
- æ¶ˆæ¯é˜Ÿåˆ—å¼‚æ­¥å¤„ç†

## 13. æ¥å£æµ‹è¯•

### 13.1 æµ‹è¯•å·¥å…·

- Postmanï¼šæ¥å£æµ‹è¯•
- Swaggerï¼šæ¥å£æ–‡æ¡£å’Œæµ‹è¯•
- JUnitï¼šå•å…ƒæµ‹è¯•

### 13.2 æµ‹è¯•ç”¨ä¾‹

- æ­£å¸¸æµç¨‹æµ‹è¯•
- å¼‚å¸¸æƒ…å†µæµ‹è¯•
- è¾¹ç•Œå€¼æµ‹è¯•
- å¹¶å‘æµ‹è¯•

## 14. éƒ¨ç½²è¯´æ˜

### 14.1 å¼€å‘ç¯å¢ƒ

- æœ¬åœ°MySQLæ•°æ®åº“
- æœ¬åœ°RedisæœåŠ¡
- æœ¬åœ°RabbitMQæœåŠ¡

### 14.2 ç”Ÿäº§ç¯å¢ƒ

- äº‘æœåŠ¡å™¨éƒ¨ç½²
- Dockerå®¹å™¨åŒ–
- Nginxåå‘ä»£ç†

### 14.3 é…ç½®ç®¡ç†

- application.ymlé…ç½®æ–‡ä»¶
- ç¯å¢ƒå˜é‡é…ç½®
- æ•°æ®åº“è¿æ¥æ± é…ç½®
