# ä»¿é—²é±¼äºŒæ‰‹äº¤æ˜“å¹³å° - ä¼ä¸šçº§å¼€å‘æµç¨‹æŒ‡å—

## ğŸ“‹ é¡¹ç›®ç°çŠ¶åˆ†æ

### å·²å®Œæˆçš„å·¥ä½œ

- âœ… éœ€æ±‚æ–‡æ¡£è®¾è®¡ï¼ˆåŠŸèƒ½ä¼˜å…ˆçº§æ˜ç¡®ï¼‰
- âœ… æ•°æ®åº“è®¾è®¡ï¼ˆ18å¼ è¡¨ï¼Œå®Œæ•´çš„å¤–é”®çº¦æŸï¼‰
- âœ… æ¥å£è®¾è®¡æ–‡æ¡£ï¼ˆRESTful APIè§„èŒƒï¼‰
- âœ… æŠ€æœ¯å®ç°è®¡åˆ’ï¼ˆSpring BootæŠ€æœ¯æ ˆï¼‰
- âœ… é¡¹ç›®åŸºç¡€æ¶æ„æ­å»ºï¼ˆMavenå¤šæ¨¡å—é¡¹ç›®ï¼‰

### å½“å‰é¡¹ç›®ç»“æ„

```
Second-hand-market/
â”œâ”€â”€ common/          # å…¬å…±æ¨¡å—
â”œâ”€â”€ POJO/           # å®ä½“ç±»æ¨¡å—
â”œâ”€â”€ server/         # æœåŠ¡ç«¯æ¨¡å—
â””â”€â”€ Second_hand-market/  # æ–‡æ¡£ç›®å½•
```

## ğŸš€ ä¼ä¸šçº§å¼€å‘æµç¨‹

### ç¬¬ä¸€é˜¶æ®µï¼šç¯å¢ƒå‡†å¤‡ä¸åŸºç¡€æ­å»ºï¼ˆç¬¬1å‘¨ï¼‰

#### 1.1 å¼€å‘ç¯å¢ƒé…ç½®

- [ ] **IDEé…ç½®**ï¼šIntelliJ IDEA + å¿…è¦æ’ä»¶

  - Lombokæ’ä»¶
  - MyBatisæ’ä»¶
  - RestfulToolæ’ä»¶
  - Gitæ’ä»¶
- [ ] **æ•°æ®åº“ç¯å¢ƒ**

  ```bash
  # åˆ›å»ºæ•°æ®åº“
  CREATE DATABASE secondhand CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

  # æ‰§è¡Œå»ºè¡¨è„šæœ¬
  mysql -u root -p secondhand < Second_hand-market/date.sql
  ```
- [ ] **Redisç¯å¢ƒ**

  ```bash
  # å¯åŠ¨RedisæœåŠ¡
  redis-server
  ```
- [ ] **RabbitMQç¯å¢ƒ**

  ```bash
  # å¯åŠ¨RabbitMQæœåŠ¡
  rabbitmq-server
  ```

#### 1.2 é¡¹ç›®ä¾èµ–å®Œå–„

- [ ] **å®Œå–„serveræ¨¡å—pom.xml**
  ```xml
  <!-- æ·»åŠ ç¼ºå¤±çš„ä¾èµ– -->
  <dependency>
      <groupId>mysql</groupId>
      <artifactId>mysql-connector-java</artifactId>
  </dependency>
  <dependency>
      <groupId>org.springframework.boot</groupId>
      <artifactId>spring-boot-starter-data-redis</artifactId>
  </dependency>
  <dependency>
      <groupId>org.springframework.boot</groupId>
      <artifactId>spring-boot-starter-amqp</artifactId>
  </dependency>
  <dependency>
      <groupId>org.springframework.boot</groupId>
      <artifactId>spring-boot-starter-security</artifactId>
  </dependency>
  <dependency>
      <groupId>org.springframework.boot</groupId>
      <artifactId>spring-boot-starter-validation</artifactId>
  </dependency>
  ```

#### 1.3 é…ç½®æ–‡ä»¶è®¾ç½®

- [ ] **application.ymlé…ç½®**
  ```yaml
  spring:
    datasource:
      url: jdbc:mysql://localhost:3306/secondhand?useUnicode=true&characterEncoding=utf8&serverTimezone=Asia/Shanghai
      username: root
      password: your_password
      driver-class-name: com.mysql.cj.jdbc.Driver

    redis:
      host: localhost
      port: 6379
      database: 0
      timeout: 5000ms

    rabbitmq:
      host: localhost
      port: 5672
      username: guest
      password: guest

  mybatis:
    mapper-locations: classpath:mapper/*.xml
    type-aliases-package: com.zhuxi.pojo.entity
    configuration:
      map-underscore-to-camel-case: true
      log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
  ```

### ç¬¬äºŒé˜¶æ®µï¼šæ ¸å¿ƒæ¨¡å—å¼€å‘ï¼ˆç¬¬2-4å‘¨ï¼‰

#### 2.1 å…¬å…±æ¨¡å—å¼€å‘ï¼ˆç¬¬2å‘¨ï¼‰

**ä¼˜å…ˆçº§ï¼šğŸ”´ æœ€é«˜**

- [ ] **ç»Ÿä¸€å“åº”ç»“æœç±»**

  ```java
  // common/src/main/java/com/zhuxi/common/result/Result.java
  @Data
  @AllArgsConstructor
  @NoArgsConstructor
  public class Result<T> {
      private Integer code;
      private String message;
      private T data;
      private Long timestamp;

      public static <T> Result<T> success(T data) {
          return new Result<>(200, "success", data, System.currentTimeMillis());
      }
  }
  ```
- [ ] **åˆ†é¡µç»“æœç±»**

  ```java
  // common/src/main/java/com/zhuxi/common/result/PageResult.java
  @Data
  @AllArgsConstructor
  @NoArgsConstructor
  public class PageResult<T> {
      private List<T> list;
      private Long total;
      private Integer page;
      private Integer size;
  }
  ```
- [ ] **ä¸šåŠ¡å¼‚å¸¸ç±»**

  ```java
  // common/src/main/java/com/zhuxi/common/exception/BusinessException.java
  public class BusinessException extends RuntimeException {
      private Integer code;
      private String message;

      public BusinessException(String message) {
          super(message);
          this.code = 500;
          this.message = message;
      }
  }
  ```
- [ ] **JWTå·¥å…·ç±»**

  ```java
  // common/src/main/java/com/zhuxi/common/utils/JwtUtil.java
  @Component
  public class JwtUtil {
      private static final String SECRET = "secondhand-market-secret-key";
      private static final int EXPIRE_TIME = 7 * 24 * 60 * 60 * 1000; // 7å¤©

      public String generateToken(String username) {
          return Jwts.builder()
                  .setSubject(username)
                  .setExpiration(new Date(System.currentTimeMillis() + EXPIRE_TIME))
                  .signWith(SignatureAlgorithm.HS512, SECRET)
                  .compact();
      }

      public String getUsernameFromToken(String token) {
          return Jwts.parser()
                  .setSigningKey(SECRET)
                  .parseClaimsJws(token)
                  .getBody()
                  .getSubject();
      }
  }
  ```

#### 2.2 å®ä½“ç±»å¼€å‘ï¼ˆç¬¬2å‘¨ï¼‰

**ä¼˜å…ˆçº§ï¼šğŸ”´ æœ€é«˜**

- [ ] **ç”¨æˆ·å®ä½“ç±»**

  ```java
  // POJO/src/main/java/com/zhuxi/pojo/entity/User.java
  @Data
  @TableName("user")
  public class User {
      @TableId(type = IdType.AUTO)
      private Long id;

      private String userSn;
      private String username;
      private String password;
      private String nickname;
      private String email;
      private String phone;
      private String avatar;
      private Integer userStatus;
      private String role;

      @TableField(fill = FieldFill.INSERT)
      private LocalDateTime createdAt;

      @TableField(fill = FieldFill.INSERT_UPDATE)
      private LocalDateTime updatedAt;
  }
  ```
- [ ] **å•†å“å®ä½“ç±»**

  ```java
  // POJO/src/main/java/com/zhuxi/pojo/entity/Product.java
  @Data
  @TableName("product")
  public class Product {
      @TableId(type = IdType.AUTO)
      private Long id;

      private String productSn;
      private Long sellerId;
      private Long shopId;
      private String title;
      private String description;
      private Long categoryId;
      private BigDecimal price;
      private Integer condition;
      private Integer userStatus;
      private String location;
      private Integer viewCount;

      @TableField(fill = FieldFill.INSERT)
      private LocalDateTime createdAt;

      @TableField(fill = FieldFill.INSERT_UPDATE)
      private LocalDateTime updatedAt;
  }
  ```
- [ ] **è®¢å•å®ä½“ç±»**

  ```java
  // POJO/src/main/java/com/zhuxi/pojo/entity/UserOrder.java
  @Data
  @TableName("user_order")
  public class UserOrder {
      @TableId(type = IdType.AUTO)
      private Long id;

      private String orderSn;
      private Long buyerId;
      private BigDecimal totalAmount;
      private Integer userStatus;
      private Long receiveAddressId;

      @TableField(fill = FieldFill.INSERT)
      private LocalDateTime createdAt;

      @TableField(fill = FieldFill.INSERT_UPDATE)
      private LocalDateTime updatedAt;
  }
  ```

#### 2.3 ç”¨æˆ·ç®¡ç†æ¨¡å—ï¼ˆç¬¬3å‘¨ï¼‰

**ä¼˜å…ˆçº§ï¼šğŸ”´ æœ€é«˜**

- [ ] **ç”¨æˆ·Mapperæ¥å£**

  ```java
  // server/src/main/java/com/zhuxi/server/mapper/UserMapper.java
  @Mapper
  public interface UserMapper extends BaseMapper<User> {
      User selectByUsername(String username);
      User selectByPhone(String phone);
      User selectByEmail(String email);
  }
  ```
- [ ] **ç”¨æˆ·Serviceæ¥å£å’Œå®ç°**

  ```java
  // server/src/main/java/com/zhuxi/server/service/UserService.java
  public interface UserService {
      Result<String> register(UserRegisterDTO registerDTO);
      Result<LoginResponseDTO> login(LoginDTO loginDTO);
      Result<UserInfoDTO> getUserInfo(String userSn);
      Result<Void> updateUserInfo(String userSn, UserUpdateDTO updateDTO);
  }
  ```
- [ ] **ç”¨æˆ·Controller**

  ```java
  // server/src/main/java/com/zhuxi/server/controller/UserController.java
  @RestController
  @RequestMapping("/api/v1/users")
  public class UserController {

      @PostMapping("/register")
      public Result<String> register(@RequestBody @Valid UserRegisterDTO registerDTO) {
          return userService.register(registerDTO);
      }

      @PostMapping("/login")
      public Result<LoginResponseDTO> login(@RequestBody @Valid LoginDTO loginDTO) {
          return userService.login(loginDTO);
      }

      @GetMapping("/{userSn}")
      public Result<UserInfoDTO> getUserInfo(@PathVariable String userSn) {
          return userService.getUserInfo(userSn);
      }
  }
  ```

#### 2.4 å•†å“ç®¡ç†æ¨¡å—ï¼ˆç¬¬4å‘¨ï¼‰

**ä¼˜å…ˆçº§ï¼šğŸ”´ æœ€é«˜**

- [ ] **å•†å“Mapperæ¥å£**

  ```java
  // server/src/main/java/com/zhuxi/server/mapper/ProductMapper.java
  @Mapper
  public interface ProductMapper extends BaseMapper<Product> {
      List<Product> selectByCondition(ProductQueryDTO queryDTO);
      Product selectByProductSn(String productSn);
      List<Product> selectBySellerId(Long sellerId);
  }
  ```
- [ ] **å•†å“Serviceæ¥å£å’Œå®ç°**

  ```java
  // server/src/main/java/com/zhuxi/server/service/ProductService.java
  public interface ProductService {
      Result<String> publishProduct(ProductPublishDTO publishDTO);
      Result<PageResult<Product>> getProductList(ProductQueryDTO queryDTO);
      Result<ProductDetailDTO> getProductDetail(String productSn);
      Result<Void> updateProduct(String productSn, ProductUpdateDTO updateDTO);
      Result<Void> deleteProduct(String productSn);
  }
  ```

### ç¬¬ä¸‰é˜¶æ®µï¼šä¸šåŠ¡åŠŸèƒ½å¼€å‘ï¼ˆç¬¬5-7å‘¨ï¼‰

#### 3.1 è®¢å•ç®¡ç†æ¨¡å—ï¼ˆç¬¬5å‘¨ï¼‰

**ä¼˜å…ˆçº§ï¼šğŸ”´ æœ€é«˜**

- [ ] **è®¢å•åˆ›å»ºæµç¨‹**

  - å•†å“çŠ¶æ€éªŒè¯
  - åº“å­˜æ£€æŸ¥
  - è®¢å•ç”Ÿæˆ
  - å•†å“çŠ¶æ€æ›´æ–°
- [ ] **è®¢å•çŠ¶æ€ç®¡ç†**

  - å¾…ä»˜æ¬¾ â†’ å¾…å‘è´§ â†’ å¾…æ”¶è´§ â†’ å·²å®Œæˆ
  - è®¢å•å–æ¶ˆé€»è¾‘
  - é€€æ¬¾å¤„ç†

#### 3.2 åœ°å€ç®¡ç†æ¨¡å—ï¼ˆç¬¬5å‘¨ï¼‰

**ä¼˜å…ˆçº§ï¼šğŸ”´ æœ€é«˜**

- [ ] **åœ°å€CRUDæ“ä½œ**
- [ ] **é»˜è®¤åœ°å€è®¾ç½®**
- [ ] **åœ°å€éªŒè¯**

#### 3.3 æ”¶è—åŠŸèƒ½ï¼ˆç¬¬6å‘¨ï¼‰

**ä¼˜å…ˆçº§ï¼šğŸ”´ æœ€é«˜**

- [ ] **å•†å“æ”¶è—/å–æ¶ˆæ”¶è—**
- [ ] **æ”¶è—åˆ—è¡¨æŸ¥è¯¢**
- [ ] **æ”¶è—çŠ¶æ€æ£€æŸ¥**

#### 3.4 æœç´¢åŠŸèƒ½ï¼ˆç¬¬6å‘¨ï¼‰

**ä¼˜å…ˆçº§ï¼šğŸ”´ æœ€é«˜**

- [ ] **å…³é”®è¯æœç´¢**
- [ ] **åˆ†ç±»ç­›é€‰**
- [ ] **ä»·æ ¼æ’åº**
- [ ] **åˆ†é¡µæŸ¥è¯¢**

### ç¬¬å››é˜¶æ®µï¼šå¢å¼ºåŠŸèƒ½å¼€å‘ï¼ˆç¬¬8-9å‘¨ï¼‰

#### 4.1 é€šè®¯æ¨¡å—ï¼ˆç¬¬8å‘¨ï¼‰

**ä¼˜å…ˆçº§ï¼šğŸŸ¡ ä¸­ç­‰**

- [ ] **WebSocketé…ç½®**
- [ ] **èŠå¤©åŠŸèƒ½å®ç°**
- [ ] **æ¶ˆæ¯å­˜å‚¨**
- [ ] **åœ¨çº¿çŠ¶æ€ç®¡ç†**

#### 4.2 è¯„ä»·ç³»ç»Ÿï¼ˆç¬¬8å‘¨ï¼‰

**ä¼˜å…ˆçº§ï¼šğŸŸ¡ ä¸­ç­‰**

- [ ] **äº¤æ˜“è¯„ä»·**
- [ ] **è¯„ä»·å±•ç¤º**
- [ ] **ä¿¡ç”¨è®¡ç®—**

#### 4.3 æ–‡ä»¶ä¸Šä¼ ï¼ˆç¬¬9å‘¨ï¼‰

**ä¼˜å…ˆçº§ï¼šğŸŸ¡ ä¸­ç­‰**

- [ ] **å›¾ç‰‡ä¸Šä¼ **
- [ ] **æ–‡ä»¶å­˜å‚¨**
- [ ] **å›¾ç‰‡å‹ç¼©**

### ç¬¬äº”é˜¶æ®µï¼šç³»ç»Ÿä¼˜åŒ–ä¸éƒ¨ç½²ï¼ˆç¬¬10å‘¨ï¼‰

#### 5.1 æ€§èƒ½ä¼˜åŒ–

**ä¼˜å…ˆçº§ï¼šğŸŸ¡ ä¸­ç­‰**

- [ ] **Redisç¼“å­˜ä¼˜åŒ–**

  ```java
  @Cacheable(value = "product", key = "#productSn")
  public Product getProductBySn(String productSn) {
      return productMapper.selectByProductSn(productSn);
  }
  ```
- [ ] **æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–**
- [ ] **åˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–**

#### 5.2 å®‰å…¨åŠ å›º

**ä¼˜å…ˆçº§ï¼šğŸ”´ æœ€é«˜**

- [ ] **Spring Securityé…ç½®**
- [ ] **JWTè®¤è¯æ‹¦æˆªå™¨**
- [ ] **å‚æ•°éªŒè¯**
- [ ] **SQLæ³¨å…¥é˜²æŠ¤**

#### 5.3 å¼‚å¸¸å¤„ç†

**ä¼˜å…ˆçº§ï¼šğŸ”´ æœ€é«˜**

- [ ] **å…¨å±€å¼‚å¸¸å¤„ç†å™¨**
  ```java
  @RestControllerAdvice
  public class GlobalExceptionHandler {

      @ExceptionHandler(BusinessException.class)
      public Result<Void> handleBusinessException(BusinessException e) {
          return Result.error(e.getCode(), e.getMessage());
      }

      @ExceptionHandler(MethodArgumentNotValidException.class)
      public Result<Void> handleValidationException(MethodArgumentNotValidException e) {
          return Result.error(400, "å‚æ•°éªŒè¯å¤±è´¥");
      }
  }
  ```

## ğŸ¯ å¼€å‘ä¼˜å…ˆçº§å»ºè®®

### ç¬¬ä¸€ä¼˜å…ˆçº§ï¼ˆå¿…é¡»å®Œæˆï¼‰

1. **ç”¨æˆ·è®¤è¯æ¨¡å—** - æ³¨å†Œã€ç™»å½•ã€JWTè®¤è¯
2. **å•†å“ç®¡ç†æ¨¡å—** - å‘å¸ƒã€æŸ¥è¯¢ã€è¯¦æƒ…
3. **è®¢å•ç®¡ç†æ¨¡å—** - åˆ›å»ºã€çŠ¶æ€ç®¡ç†
4. **åŸºç¡€æœç´¢åŠŸèƒ½** - å…³é”®è¯æœç´¢ã€åˆ†é¡µ

### ç¬¬äºŒä¼˜å…ˆçº§ï¼ˆé‡è¦åŠŸèƒ½ï¼‰

1. **åœ°å€ç®¡ç†** - æ”¶è´§åœ°å€CRUD
2. **æ”¶è—åŠŸèƒ½** - å•†å“æ”¶è—
3. **æ–‡ä»¶ä¸Šä¼ ** - å›¾ç‰‡ä¸Šä¼ 
4. **å¼‚å¸¸å¤„ç†** - å…¨å±€å¼‚å¸¸å¤„ç†

### ç¬¬ä¸‰ä¼˜å…ˆçº§ï¼ˆå¢å¼ºåŠŸèƒ½ï¼‰

1. **é€šè®¯åŠŸèƒ½** - WebSocketèŠå¤©
2. **è¯„ä»·ç³»ç»Ÿ** - äº¤æ˜“è¯„ä»·
3. **ç¼“å­˜ä¼˜åŒ–** - Redisç¼“å­˜
4. **æ€§èƒ½ä¼˜åŒ–** - æ•°æ®åº“ä¼˜åŒ–

## ğŸ“ å¼€å‘è§„èŒƒ

### ä»£ç è§„èŒƒ

- ä½¿ç”¨Lombokå‡å°‘æ ·æ¿ä»£ç 
- ç»Ÿä¸€å¼‚å¸¸å¤„ç†
- ç»Ÿä¸€å“åº”æ ¼å¼
- å‚æ•°éªŒè¯ä½¿ç”¨@Valid
- æ—¥å¿—è®°å½•ä½¿ç”¨@Slf4j

### æ•°æ®åº“è§„èŒƒ

- ä½¿ç”¨ä¸šåŠ¡ç¼–å·è€Œéæ•°æ®åº“ID
- å¤–é”®çº¦æŸä¿è¯æ•°æ®ä¸€è‡´æ€§
- åˆç†çš„ç´¢å¼•è®¾è®¡
- å­—æ®µæ³¨é‡Šå®Œæ•´

### APIè§„èŒƒ

- RESTfulè®¾è®¡é£æ ¼
- ç»Ÿä¸€çš„å“åº”æ ¼å¼
- åˆç†çš„HTTPçŠ¶æ€ç 
- å®Œæ•´çš„é”™è¯¯ä¿¡æ¯

## ğŸš€ å¿«é€Ÿå¼€å§‹æŒ‡å—

### 1. ç«‹å³å¼€å§‹çš„å·¥ä½œ

```bash
# 1. å®Œå–„serveræ¨¡å—ä¾èµ–
# ç¼–è¾‘ server/pom.xmlï¼Œæ·»åŠ ç¼ºå¤±çš„ä¾èµ–

# 2. åˆ›å»ºé…ç½®æ–‡ä»¶
# åˆ›å»º server/src/main/resources/application.yml

# 3. æ‰§è¡Œæ•°æ®åº“è„šæœ¬
mysql -u root -p secondhand < Second_hand-market/date.sql

# 4. å¯åŠ¨é¡¹ç›®
cd server
mvn spring-boot:run
```

### 2. ç¬¬ä¸€ä¸ªæ¥å£å¼€å‘

å»ºè®®ä»ç”¨æˆ·æ³¨å†Œæ¥å£å¼€å§‹ï¼š

1. åˆ›å»ºUserå®ä½“ç±»
2. åˆ›å»ºUserMapperæ¥å£
3. åˆ›å»ºUserServiceå®ç°
4. åˆ›å»ºUserController
5. æµ‹è¯•æ¥å£

### 3. å¼€å‘é¡ºåºå»ºè®®

```
Week 1: ç¯å¢ƒæ­å»º + ç”¨æˆ·è®¤è¯
Week 2: å•†å“ç®¡ç†åŸºç¡€åŠŸèƒ½
Week 3: è®¢å•ç®¡ç† + åœ°å€ç®¡ç†
Week 4: æœç´¢åŠŸèƒ½ + æ”¶è—åŠŸèƒ½
Week 5: æ–‡ä»¶ä¸Šä¼  + å¼‚å¸¸å¤„ç†
Week 6: æ€§èƒ½ä¼˜åŒ– + æµ‹è¯•
```

## ğŸ“Š é¡¹ç›®é‡Œç¨‹ç¢‘

- **Week 2**: ç”¨æˆ·è®¤è¯å®Œæˆï¼Œå¯ä»¥æ³¨å†Œç™»å½•
- **Week 4**: å•†å“ç®¡ç†å®Œæˆï¼Œå¯ä»¥å‘å¸ƒå’Œæµè§ˆå•†å“
- **Week 6**: è®¢å•æµç¨‹å®Œæˆï¼Œå¯ä»¥ä¸‹å•è´­ä¹°
- **Week 8**: åŸºç¡€åŠŸèƒ½å®Œæˆï¼Œç³»ç»Ÿå¯æ­£å¸¸ä½¿ç”¨
- **Week 10**: é¡¹ç›®å®Œæˆï¼Œå¯ä»¥éƒ¨ç½²ä¸Šçº¿

è¿™ä¸ªå¼€å‘æµç¨‹éµå¾ªä¼ä¸šçº§å¼€å‘æ ‡å‡†ï¼Œç¡®ä¿é¡¹ç›®çš„å¯ç»´æŠ¤æ€§ã€å¯æ‰©å±•æ€§å’Œç¨³å®šæ€§ã€‚æŒ‰ç…§è¿™ä¸ªæµç¨‹å¼€å‘ï¼Œä½ å°†è·å¾—ä¸€ä¸ªå®Œæ•´çš„ã€ç¬¦åˆä¼ä¸šæ ‡å‡†çš„äºŒæ‰‹äº¤æ˜“å¹³å°é¡¹ç›®ã€‚
