<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zhuxi.order.module.infrastructure.mapper.OrderMapper">

    <insert id="insertOrder">
        INSERT INTO user_order(orderSn, buyer_id, total_amount, receive_address_id)
        VALUES (#{orderSn}, #{buyerId}, #{totalAmount}, #{receiveAddressId})
    </insert>

    <insert id="insertOrderDetail">
        INSERT INTO order_detail(order_id, product_id, sku_id, seller_id, quantity, unit_price, product_snapshot)
        VALUES (#{orderId}, #{productId}, #{skuId}, #{sellerId}, #{quantity}, #{unitPrice}, #{productSnapshot})
    </insert>
    <select id="getProductInfoAndSpec" resultType="com.zhuxi.order.module.domain.objectValue.ProductInfo">
         SELECT p.price,p.description,p.title,ps.specifications
         FROM product p JOIN product_spec ps ON p.id = ps.product_id
            WHERE p.id = #{productId} AND ps.id = #{skuId}
    </select>

</mapper>